import{_ as I}from"./AppLayout.vue_vue_type_script_setup_true_lang-BtxoXEAO.js";import{_ as T}from"./PageContainer.vue_vue_type_script_setup_true_lang-BEBW8e7I.js";import{d as B,r as b,j as p,s as j,q as _,e as L,o as R,a as n,b as y,g as O,t as A,w as N,F as $,h as H,c as K}from"./app-DmiFfQ2G.js";import"./SecondaryButton.vue_vue_type_script_setup_true_lang-CqX5B3hd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextLink.vue_vue_type_script_setup_true_lang-_a-QFXiR.js";const J={id:"scaleDisplay"},Q=["checked"],Z=["checked"],ee=["checked"],te=["checked"],h=800,m=400,s=40,oe=B({__name:"KonvaGridClaude",setup(P){const c=b(null),d=b("solution1"),W=b(1),S=[5,4,3,2.5,2,1.5,1,.9,.8,.7,.6,.5,.4,.3,.2,.1,.05];let r=6;const f=b({width:h,height:m,draggable:!0,scaleX:S[r],scaleY:S[r],x:0,y:0}),D=b({draggable:!1,x:0,y:0,clip:null}),u=p(()=>{if(!c.value)return{x1:0,y1:0,x2:0,y2:0,offset:{x:0,y:0}};const t=c.value.getNode();return{x1:0,y1:0,x2:t.width(),y2:t.height(),offset:{x:x(t.position().x),y:x(t.position().y)}}}),l=p(()=>({x1:-u.value.offset.x,y1:-u.value.offset.y,x2:x(h)-u.value.offset.x,y2:x(m)-u.value.offset.y})),U=p(()=>({x1:Math.min(u.value.x1,l.value.x1),y1:Math.min(u.value.y1,l.value.y1),x2:Math.max(u.value.x2,l.value.x2),y2:Math.max(u.value.y2,l.value.y2)})),w=p(()=>{if(!c.value)return{x:0,y:0};const t=c.value.getNode();return{x:Math.ceil(x(t.position().x)/s)*s,y:Math.ceil(x(t.position().y)/s)*s}}),C=p(()=>({x1:-w.value.x,y1:-w.value.y,x2:x(h)-w.value.x+s,y2:x(m)-w.value.y+s})),E=p(()=>({x1:Math.min(u.value.x1,C.value.x1),y1:Math.min(u.value.y1,C.value.y1),x2:Math.max(u.value.x2,C.value.x2),y2:Math.max(u.value.y2,C.value.y2)})),F=p(()=>{const t=[];let e;switch(d.value){case"solution1":const a=f.value.width,i=f.value.height,g=Math.round(a/s),v=Math.round(i/s);for(let o=0;o<=g;o++)t.push({key:`v-${o}`,config:{x:o*s,points:[0,0,0,i],stroke:"rgba(0, 0, 0, 0.2)",strokeWidth:1}});for(let o=0;o<=v;o++)t.push({key:`h-${o}`,config:{y:o*s,points:[0,0,a,0],stroke:"rgba(0, 0, 0, 0.2)",strokeWidth:1}});break;case"solution2":e=U.value;break;case"solution3":case"solution4":e=E.value;break}if(d.value!=="solution1"){const a=e.x2-e.x1,i=e.y2-e.y1,g=Math.round(a/s),v=Math.round(i/s);for(let o=0;o<=g;o++)t.push({key:`v-${o}`,config:{x:e.x1+o*s,y:e.y1,points:[0,0,0,i],stroke:"rgba(0, 0, 0, 0.2)",strokeWidth:1}});for(let o=0;o<=v;o++)t.push({key:`h-${o}`,config:{x:e.x1,y:e.y1+o*s,points:[0,0,a,0],stroke:"rgba(0, 0, 0, 0.2)",strokeWidth:1}})}return t}),X=p(()=>({x:l.value.x1+2,y:l.value.y1+2,width:l.value.x2-l.value.x1-4,height:l.value.y2-l.value.y1-4,stroke:"red",strokeWidth:4}));j(d,t=>{t==="solution4"?D.value.clip={x:l.value.x1,y:l.value.y1,width:l.value.x2-l.value.x1,height:l.value.y2-l.value.y1}:D.value.clip=null});function x(t){return t/f.value.scaleX}function G(t){t.evt.preventDefault();const e=c.value.getNode(),a=e.scaleX(),i=e.getPointerPosition(),g={x:(i.x-e.x())/a,y:(i.y-e.y())/a};let v=t.evt.deltaY>0?1:-1;t.evt.ctrlKey&&(v=-v),v>0?r=r>0?r-1:r:r=r<S.length-1?r+1:r;const o=S[r];f.value.scaleX=o,f.value.scaleY=o;const k={x:i.x-g.x*o,y:i.y-g.y*o};f.value.x=k.x,f.value.y=k.y,W.value=o}function V(){}function Y(){const t=c.value.getNode().toDataURL();z(t,"stage.png")}function q(){const t=c.value.getNode().toDataURL({x:-200,y:-200,width:1200,height:800});z(t,"stage.png")}function z(t,e){const a=document.createElement("a");a.download=e,a.href=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}function M(t){const e=t.target;d.value=e.value}return(t,e)=>{const a=_("v-line"),i=_("v-rect"),g=_("v-layer"),v=_("v-circle"),o=_("v-stage");return R(),L($,null,[e[8]||(e[8]=n("p",null,"Select a solution in sequence, use mouse wheel to zoom in and out",-1)),e[9]||(e[9]=n("p",null,"Red box is the viewport (initial stage size), blue is Konva Stage.",-1)),n("p",null,[e[0]||(e[0]=O("Scale: ")),n("span",J,A(W.value),1)]),n("p",null,[n("input",{id:"solution1",type:"radio",class:"mr-1",name:"solutionNo",value:"solution1",checked:d.value==="solution1",onChange:M},null,40,Q),e[1]||(e[1]=n("label",{for:"solution1"},"Solution 1 - grid on stage",-1)),e[2]||(e[2]=n("br",null,null,-1)),n("input",{id:"solution2",type:"radio",class:"mr-1",name:"solutionNo",value:"solution2",checked:d.value==="solution2",onChange:M},null,40,Z),e[3]||(e[3]=n("label",{for:"solution2"},"Solution 2 - grid on merged",-1)),e[4]||(e[4]=n("br",null,null,-1)),n("input",{id:"solution3",type:"radio",class:"mr-1",name:"solutionNo",value:"solution3",checked:d.value==="solution3",onChange:M},null,40,ee),e[5]||(e[5]=n("label",{for:"solution3"},"Solution 3 - grid on merged inc fix for dancing grid effect",-1)),e[6]||(e[6]=n("br",null,null,-1)),n("input",{id:"solution4",type:"radio",class:"mr-1",name:"solutionNo",value:"solution4",checked:d.value==="solution4",onChange:M},null,40,te),e[7]||(e[7]=n("label",{for:"solution4"},"Solution 4 - optimised drawing via clip function",-1))]),n("p",{id:"buttons",class:"mt-2 space-x-2"},[n("button",{class:"rounded border border-gray-300 bg-gray-200 px-4 py-1 hover:bg-gray-300",onClick:Y}," Save viewport image "),n("button",{class:"rounded border border-gray-300 bg-gray-200 px-4 py-1 hover:bg-gray-300",onClick:q}," Save viewport plus 200px around ")]),y(o,{ref_key:"stageRef",ref:c,config:f.value,onWheel:G,onDragend:V},{default:N(()=>[y(g,{config:D.value},{default:N(()=>[(R(!0),L($,null,H(F.value,k=>(R(),K(a,{key:k.key,config:k.config},null,8,["config"]))),128)),y(i,{config:X.value},null,8,["config"])]),_:1},8,["config"]),y(g,null,{default:N(()=>[y(i,{config:{name:"rStageFill",x:2,y:2,width:h-4,height:m-4,fill:"yellow",opacity:.2}},null,8,["config"]),y(i,{config:{name:"rStageBorder",x:2,y:2,width:h-4,height:m-4,strokeWidth:4,stroke:"green"}},null,8,["config"]),y(i,{config:{name:"r1",x:0,y:0,width:40,height:40,fill:"blue",draggable:!0}}),y(v,{config:{name:"circle",x:h/2,y:m/2,radius:50,fill:"orange",draggable:!0}},null,8,["config"])]),_:1})]),_:1},8,["config"])],64)}}}),re=B({layout:I,__name:"KonvaGridClaudePage",setup(P){return(c,d)=>(R(),K(T,{title:"KonvaGridClaude","show-footer":!1},{default:N(()=>[y(oe)]),_:1}))}});export{re as default};
