import{_ as I}from"./AppLayout.vue_vue_type_script_setup_true_lang-BtxoXEAO.js";import{_ as T}from"./PageContainer.vue_vue_type_script_setup_true_lang-BEBW8e7I.js";import{d as P,r as k,j as f,q as _,e as z,o as R,a as p,b as r,g as Y,t as j,w as D,F as B,h as O,c as U}from"./app-DmiFfQ2G.js";import"./SecondaryButton.vue_vue_type_script_setup_true_lang-CqX5B3hd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextLink.vue_vue_type_script_setup_true_lang-_a-QFXiR.js";const X={id:"scaleDisplay"},d=800,g=400,s=40,A=P({__name:"KonvaGridGemini",setup(W){const h=k(null),C=k(1),G=[5,4,3,2.5,2,1.5,1,.9,.8,.7,.6,.5,.4,.3,.2,.1,.05];let i=6;const u=k({x:0,y:0}),m=k({x:1,y:1}),b=f(()=>({x1:0,y1:0,x2:d,y2:g,offset:{x:v(u.value.x),y:v(u.value.y)}})),n=f(()=>({x1:-b.value.offset.x,y1:-b.value.offset.y,x2:v(d)-b.value.offset.x,y2:v(g)-b.value.offset.y})),w=f(()=>({x:Math.ceil(v(u.value.x)/s)*s,y:Math.ceil(v(u.value.y)/s)*s})),S=f(()=>({x1:-w.value.x,y1:-w.value.y,x2:v(d)-w.value.x+s,y2:v(g)-w.value.y+s})),c=f(()=>({x1:Math.min(0,S.value.x1),y1:Math.min(0,S.value.y1),x2:Math.max(d,S.value.x2),y2:Math.max(g,S.value.y2)})),E=f(()=>{const e=[],t=c.value.x2-c.value.x1,a=c.value.y2-c.value.y1,o=Math.round(t/s),y=Math.round(a/s);for(let l=0;l<=o;l++)e.push({x:c.value.x1+l*s,y:c.value.y1,points:[0,0,0,a]});for(let l=0;l<=y;l++)e.push({x:c.value.x1,y:c.value.y1+l*s,points:[0,0,t,0]});return e}),F=f(()=>({x:n.value.x1,y:n.value.y1,width:n.value.x2-n.value.x1,height:n.value.y2-n.value.y1}));function v(e){return e/m.value.x}function K(e){e.evt.preventDefault();const t=h.value.getStage(),a=m.value.x,o=t.getPointerPosition(),y={x:(o.x-u.value.x)/a,y:(o.y-u.value.y)/a};(e.evt.deltaY>0?1:-1)>0?i=i>0?i-1:i:i=i<G.length-1?i+1:i;const x=G[i];m.value={x,y:x},u.value={x:o.x-y.x*x,y:o.y-y.y*x},C.value=x}function N(){}function V(){const e=h.value.toDataURL();L(e,"stage.png")}function $(){const e=h.value.toDataURL({x:-200,y:-200,width:1200,height:800});L(e,"stage.png")}function L(e,t){const a=document.createElement("a");a.download=t,a.href=e,document.body.appendChild(a),a.click(),document.body.removeChild(a)}return(e,t)=>{const a=_("v-line"),o=_("v-rect"),y=_("v-layer"),l=_("v-circle"),x=_("v-stage");return R(),z(B,null,[t[1]||(t[1]=p("p",null,"Select a solution in sequence, use mouse wheel to zoom in and out",-1)),t[2]||(t[2]=p("p",null,"Red box is the viewport (initial stage size), blue is Konva Stage.",-1)),p("p",null,[t[0]||(t[0]=Y("Scale: ")),p("span",X,j(C.value),1)]),p("p",{id:"buttons",class:"mt-2 space-x-2"},[p("button",{class:"rounded border border-gray-300 bg-gray-200 px-4 py-1 hover:bg-gray-300",onClick:V}," Save viewport image "),p("button",{class:"rounded border border-gray-300 bg-gray-200 px-4 py-1 hover:bg-gray-300",onClick:$}," Save viewport plus 200px around ")]),r(x,{ref_key:"stageRef",ref:h,config:{width:d,height:g,draggable:!0,x:u.value.x,y:u.value.y,scaleX:m.value.x,scaleY:m.value.y},onWheel:K,onDragend:N},{default:D(()=>[r(y,{config:{clip:F.value}},{default:D(()=>[(R(!0),z(B,null,O(E.value,(M,q)=>(R(),U(a,{key:q,config:{x:M.x,y:M.y,points:M.points,stroke:"rgba(0, 0, 0, 0.2)",strokeWidth:1}},null,8,["config"]))),128)),r(o,{config:{x:n.value.x1+2,y:n.value.y1+2,width:n.value.x2-n.value.x1-4,height:n.value.y2-n.value.y1-4,strokeWidth:4,stroke:"red"}},null,8,["config"])]),_:1},8,["config"]),r(y,null,{default:D(()=>[r(o,{config:{name:"rStageFill",x:2,y:2,width:d-4,height:g-4,fill:"yellow",opacity:.2}},null,8,["config"]),r(o,{config:{name:"rStageBorder",x:2,y:2,width:d-4,height:g-4,strokeWidth:4,stroke:"green"}},null,8,["config"]),r(o,{config:{name:"r1",x:0,y:0,width:40,height:40,fill:"blue",draggable:!0}}),r(l,{config:{name:"circle",x:d/2,y:g/2,radius:50,fill:"orange",draggable:!0}},null,8,["config"])]),_:1})]),_:1},8,["config"])],64)}}}),ae=P({layout:I,__name:"KonvaGridGeminiPage",setup(W){return(h,C)=>(R(),U(T,{title:"KonvaGridGemini","show-footer":!1},{default:D(()=>[r(A)]),_:1}))}});export{ae as default};
