import{_ as Ft}from"./AppLayout.vue_vue_type_script_setup_true_lang-DzEFxBkw.js";import{_ as Vt}from"./PageContainer.vue_vue_type_script_setup_true_lang-CyEhPB0L.js";import{e as $,o as S,d as q,y as Yt,C as Ht,a as n,i as Nt,k as b,u as v,z as C,A as Ut,b as d,w as k,g as Rt,r as y,B as j,j as g,s as Gt,q as D,t as E,c as ht,F as Z,h as vt,D as Ot}from"./app-C3xBQ3ZE.js";import{_ as at}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as jt}from"./PrimaryButton.vue_vue_type_script_setup_true_lang-DV7t34Po.js";import"./SecondaryButton.vue_vue_type_script_setup_true_lang-Dmu9JfD_.js";import"./TextLink.vue_vue_type_script_setup_true_lang-LunYTnvm.js";const Zt={};function qt(L,u){return S(),$("div",null,"Add Bed")}const Kt=at(Zt,[["render",qt]]),Jt={class:"space-y-3 p-2 text-sm text-black"},Qt={class:"space-y-1"},te={class:"space-y-1"},ee={class:"space-y-1"},le={class:"space-y-1"},ne={class:"space-y-1"},ae={class:"w-full pt-6"},oe=q({__name:"MenuSettings",setup(L){const u=Yt("plots"),s=Ht({...u,location_combined:`${u.location_name} (${u.location_lat}, ${u.location_lng})`});function a(){const I=s.location_combined.match(/^([A-Z\s\-(),.']+)\s\((-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)\)/i);if(I){const[i,f,B,K]=I;s.location_name=f,s.location_lat=Number(B),s.location_lng=Number(K)}}function P(){a(),s.put(`plots/${u.id}`)}return(I,i)=>(S(),$("div",null,[i[15]||(i[15]=n("h2",{class:"bg-green-200 p-2 text-lg tracking-wide text-green-800"}," Plot Settings ",-1)),n("form",{onSubmit:Nt(P,["prevent"])},[n("div",Jt,[n("div",Qt,[i[8]||(i[8]=n("label",{class:"text-xs font-semibold uppercase tracking-wide"},"Name:",-1)),b(n("input",{"onUpdate:modelValue":i[0]||(i[0]=f=>v(s).name=f),class:"w-full rounded border border-gray-300 bg-white",type:"text"},null,512),[[C,v(s).name]])]),n("div",te,[i[9]||(i[9]=n("label",{class:"text-xs font-semibold uppercase tracking-wide"},"Width:",-1)),b(n("input",{"onUpdate:modelValue":i[1]||(i[1]=f=>v(s).width=f),class:"w-full rounded border border-gray-300 bg-white",type:"number",step:"any"},null,512),[[C,v(s).width]])]),n("div",ee,[i[10]||(i[10]=n("label",{class:"text-xs font-semibold uppercase tracking-wide"},"Length:",-1)),b(n("input",{"onUpdate:modelValue":i[2]||(i[2]=f=>v(s).length=f),class:"w-full rounded border border-gray-300 bg-white",type:"number",step:"any"},null,512),[[C,v(s).length]])]),n("div",le,[i[11]||(i[11]=n("label",{class:"text-xs font-semibold uppercase tracking-wide"},"Location:",-1)),b(n("input",{"onUpdate:modelValue":i[3]||(i[3]=f=>v(s).location_lat=f),class:"w-full rounded border border-gray-300 bg-white",type:"hidden"},null,512),[[C,v(s).location_lat]]),b(n("input",{"onUpdate:modelValue":i[4]||(i[4]=f=>v(s).location_lng=f),class:"w-full rounded border border-gray-300 bg-white",type:"hidden"},null,512),[[C,v(s).location_lng]]),b(n("input",{"onUpdate:modelValue":i[5]||(i[5]=f=>v(s).location_name=f),class:"w-full rounded border border-gray-300 bg-white",type:"hidden"},null,512),[[C,v(s).location_name]]),b(n("input",{"onUpdate:modelValue":i[6]||(i[6]=f=>v(s).location_combined=f),class:"w-full rounded border border-gray-300 bg-white",type:"text"},null,512),[[C,v(s).location_combined]])]),n("div",ne,[i[13]||(i[13]=n("label",{class:"text-xs font-semibold uppercase tracking-wide"},"Preferred unit of measure:",-1)),b(n("select",{"onUpdate:modelValue":i[7]||(i[7]=f=>v(s).units=f),class:"w-full rounded border border-gray-300 bg-white"},i[12]||(i[12]=[n("option",{value:"metres"}," Metres ",-1),n("option",{value:"yards"}," Yards ",-1)]),512),[[Ut,v(s).units]])]),n("div",ae,[d(jt,{type:"submit"},{default:k(()=>i[14]||(i[14]=[Rt(" Update ")])),_:1})])])],32)]))}}),ie={};function ue(L,u){return S(),$("div",null,"Add Structure")}const se=at(ie,[["render",ue]]),re={};function ce(L,u){return S(),$("div",null,"Add Plant")}const de=at(re,[["render",ce]]),ve={class:"flex flex-col"},he={class:"flex justify-between"},ge=q({__name:"SidePanel",setup(L){const u=y("MenuSettings");return(s,a)=>(S(),$("div",ve,[n("div",he,[n("a",{href:"#",onClick:a[0]||(a[0]=P=>u.value="MenuStructure")},a[4]||(a[4]=[n("img",{id:"structureMenuButton",alt:"Activate Structures Layer & show Add Structures menu",class:"size-12",src:"/images/newstructure.png",title:"Activate Structures Layer & show Add Structures menu"},null,-1)])),n("a",{href:"#",onClick:a[1]||(a[1]=P=>u.value="MenuBed")},a[5]||(a[5]=[n("img",{id:"bedMenuButton",alt:"Activate Beds Layer & show Add Beds menu",class:"size-12",src:"/images/newbed.png",title:"Activate Beds Layer & show Add Beds menu"},null,-1)])),n("a",{href:"#",onClick:a[2]||(a[2]=P=>u.value="MenuPlant")},a[6]||(a[6]=[n("img",{id:"plantMenuButton",alt:"Activate Plants Layer & show Add plants menu",class:"size-12",src:"/images/newplant.png",title:"Activate Plants Layer & show Add plants menu"},null,-1)])),n("a",{href:"#",onClick:a[3]||(a[3]=P=>u.value="MenuSettings")},a[7]||(a[7]=[n("img",{id:"plotMenuButton",alt:"Show Plot Settings menu",class:"size-12",src:"/images/cogicon.png",title:"Show Plot Settings menu"},null,-1)]))]),n("div",null,[b(d(se,null,null,512),[[j,u.value==="MenuStructure"]]),b(d(Kt,null,null,512),[[j,u.value==="MenuBed"]]),b(d(de,null,null,512),[[j,u.value==="MenuPlant"]]),b(d(oe,null,null,512),[[j,u.value==="MenuSettings"]])])]))}}),fe={class:"h-[50px] space-x-2 bg-gray-300 p-2 text-xs"},pe={class:"flex"},me={class:"w-full"},xe=q({__name:"VegPlot",props:{plots:{},plotConfig:{}},setup(L){var ut,st,rt,ct,dt;const u=L,s=((ut=u.plotConfig)==null?void 0:ut.SCROLLBAR_SIZE)||12,a=((st=u.plotConfig)==null?void 0:st.UNIT_PIXELS)||100,P=((rt=u.plotConfig)==null?void 0:rt.SIDEPANEL_WIDTH)||220,I=((ct=u.plotConfig)==null?void 0:ct.VERTICAL_OFFSET)||116,i=((dt=u.plotConfig)==null?void 0:dt.PADDING_PIXELS)||50,f=y(0),B=y(null),K=y(null),gt=y(null),ft=y(null),h=y(1),l=y({width:window.innerWidth-P,height:window.innerHeight-I}),x=y(0),w=y(0),J=y(!1),pt=y(null),mt=y(null),Q=g(()=>{const t=A(l.value.width);return u.plots.width*a<=t}),tt=g(()=>{const t=A(l.value.height);return u.plots.length*a<=t}),F=g(()=>{const t=A(l.value.width),o=u.plots.width*a;if(Q.value){const e=(t-o)/2;return h.value>1?e<i?e:Math.max(i,e):e}return i}),V=g(()=>{const t=A(l.value.height),o=u.plots.length*a;if(tt.value){const e=(t-o)/2;return h.value>1?e<i?e:Math.max(i,e):e}return i}),W=g(()=>({x:F.value,y:V.value,width:u.plots.width*a,height:u.plots.length*a,fill:"#eee",stroke:"black"})),p=g(()=>{const t=l.value.width,e=W.value.width+F.value*2;return Q.value?Math.max(e,A(t)):e}),m=g(()=>{const t=l.value.height,e=W.value.height+V.value*2;return tt.value?Math.max(e,A(t)):e}),R=g(()=>Math.min(0,l.value.width-p.value*h.value)),G=g(()=>Math.min(0,l.value.height-m.value*h.value)),xt=g(()=>({x:x.value,y:w.value,width:p.value,height:m.value,scaleX:h.value,scaleY:h.value,draggable:!0,dragBoundFunc:t=>{const o=Math.max(R.value,Math.min(0,t.x)),e=Math.max(G.value,Math.min(0,t.y));return{x:o,y:e}}})),X=g(()=>Math.floor(m.value*h.value)>l.value.height),Y=g(()=>X.value?Math.max(20,l.value.height/(m.value*h.value)*l.value.height):0),H=g(()=>Math.floor(p.value*h.value)>l.value.width),N=g(()=>H.value?Math.max(20,l.value.width/(p.value*h.value)*l.value.width):0),wt=g(()=>{if(!X.value)return 0;const t=-w.value,o=m.value*h.value-l.value.height,e=t/o*(l.value.height-Y.value);return Math.max(0,Math.min(l.value.height-Y.value,e))}),_t=g(()=>{if(!H.value)return 0;const t=-x.value,o=p.value*h.value-l.value.width,e=t/o*(l.value.width-N.value);return Math.max(0,Math.min(l.value.width-N.value,e))}),yt=g(()=>{const t=[],o=W.value.x*h.value,e=W.value.width,c=Math.ceil(e/a)+1;for(let r=0;r<c;r++)t.push({x:o+r*a*h.value,text:`${r}m`});return t}),bt=g(()=>{const t=[],o=W.value.y*h.value,e=W.value.height,c=Math.ceil(e/a)+1;for(let r=0;r<c;r++)t.push({y:o+r*a*h.value,text:`${r}m`});return t}),et=[5,4,3,2.5,2,1.5,1,.9,.8,.7,.6,.5,.4,.3,.2,.1,.05];let O=et.indexOf(h.value);function A(t){return t/h.value}function St(t){x.value=t.target.x(),w.value=t.target.y()}function Mt(){l.value.width=window.innerWidth-P,l.value.height=window.innerHeight-I}function ot(t,o){const e=h.value,c=B.value.getNode().getPointerPosition();if(!c)return;const r={x:c.x-B.value.getNode().x(),y:c.y-B.value.getNode().y()},M={x:(r.x-x.value)/e,y:(r.y-w.value)/e};O=(t?t.evt.deltaY>0?-1:1:o>1?1:-1)>0?Math.max(0,O-1):Math.min(et.length-1,O+1);const T=et[O];h.value=T,x.value=r.x-M.x*T,w.value=r.y-M.y*T;const lt=Math.min(0,l.value.width-p.value*T),_=Math.min(0,l.value.height-m.value*T);x.value=Math.max(lt,Math.min(0,x.value)),w.value=Math.max(_,Math.min(0,w.value))}function kt(t){const o=-t.evt.deltaY;if(X.value){const e=w.value+o;w.value=Math.max(G.value,Math.min(0,e))}else if(H.value){const e=x.value+o;x.value=Math.max(R.value,Math.min(0,e))}}function $t(t){if(t.evt.preventDefault(),J.value){ot(t);return}X.value&&kt(t)}window.addEventListener("resize",Mt),window.addEventListener("keydown",t=>{t.key==="Control"&&(J.value=!0)}),window.addEventListener("keyup",t=>{t.key==="Control"&&(J.value=!1)});const Lt=g(()=>h.value>=1?p.value:A(p.value)),Pt=g(()=>h.value>=1?m.value:A(m.value));function At(){x.value=H.value?Math.max(R.value,0):0,w.value=X.value?Math.max(G.value,0):0}const Tt=g(()=>{let t="";const o=V.value%a,e=Math.ceil(m.value/a);for(let c=0;c<e;c++){const r=o+c*a;t+=`M 0 ${r} L ${p.value} ${r} 
`}return{data:t,stroke:"gray",strokeWidth:.5}}),Wt=g(()=>{let t="";const o=V.value%(a/10),e=Math.ceil(m.value/a)*10;for(let c=0;c<e;c++){const r=o+c*a/10;t+=`M 0 ${r} L ${p.value} ${r} 
`}return{data:t,stroke:"gray",strokeWidth:.2}}),Ct=g(()=>{let t="";const o=F.value%a,e=Math.ceil(p.value/a);for(let c=0;c<e;c++){const r=o+c*a;t+=`M ${r} 0 L ${r} ${m.value} `}return{data:t,stroke:"gray",strokeWidth:.5}}),Dt=g(()=>{let t="";const o=F.value%(a/10),e=Math.ceil(p.value/a)*10;for(let c=0;c<e;c++){const r=o+c*a/10;t+=`M ${r} 0 L ${r} ${m.value} `}return{data:t,stroke:"gray",strokeWidth:.2}});Gt([()=>u.plots.length,()=>u.plots.width,()=>l.value.height,()=>l.value.width],At,{immediate:!0});function Et(t){const o=t.target.y(),e=l.value.height-Y.value,c=o/e,r=m.value*h.value-l.value.height,M=c*r;w.value=-M}function It(t){const o=t.target.x(),e=l.value.width-N.value,c=o/e,r=p.value*h.value-l.value.width,M=c*r;x.value=-M}let z=0;function Bt(t){t.evt.touches.length>=2&&(z=it(t.evt.touches))}function Xt(t){if(t.evt.touches.length>=2){t.evt.preventDefault();const o=it(t.evt.touches);z===0&&(z=o);const e=o/z;ot(null,e),z=o}}function zt(){z=0}function it(t){const o=t[0],e=t[1];return Math.sqrt((e.clientX-o.clientX)**2+(e.clientY-o.clientY)**2)}return(t,o)=>{const e=D("v-rect"),c=D("v-path"),r=D("v-group"),M=D("v-layer"),U=D("v-line"),T=D("v-text"),lt=D("v-stage");return S(),$("div",null,[n("p",fe,[n("span",null,"Scale: "+E(h.value),1),n("span",null,"stage: "+E(`(${l.value.width}, ${l.value.height})`),1),n("span",null,"fitsOnStageX: "+E(`(${Q.value}, ${tt.value})`),1),n("span",null,"padding: "+E(`(${F.value.toFixed(0)}, ${V.value.toFixed(0)})`),1),n("span",null,"min: "+E(`(${R.value.toFixed(0)}, ${G.value.toFixed(0)})`),1),n("span",null,"gridWidth: "+E(`(${p.value.toFixed(0)}, ${m.value.toFixed(0)})`),1),n("span",null,"gridConfigXY: "+E(`(${x.value.toFixed(0)}, ${w.value.toFixed(0)})`),1)]),n("div",pe,[n("div",null,[(S(),ht(lt,{ref_key:"stage",ref:B,key:f.value,config:l.value,onWheel:$t,onTouchstart:Bt,onTouchstartend:zt,onTouchmove:Xt},{default:k(()=>[d(M,{ref_key:"background",ref:K,name:"background"},{default:k(()=>[d(r,{id:"grid-group",ref_key:"grid",ref:gt,name:"grid",config:xt.value,onDragmove:St},{default:k(()=>[d(e,{name:"grid-background",config:{x:0,y:0,width:Lt.value,height:Pt.value,fill:"#abb"}},null,8,["config"]),d(e,{name:"plot-area",config:W.value},null,8,["config"]),d(c,{config:Wt.value},null,8,["config"]),d(c,{config:Tt.value},null,8,["config"]),d(c,{config:Dt.value},null,8,["config"]),d(c,{config:Ct.value},null,8,["config"])]),_:1},8,["config"])]),_:1},512),d(M,{ref_key:"axesLayer",ref:ft,name:"axes",config:{visible:!1}},{default:k(()=>[d(U,{name:"x-axis",config:{x:0,y:10,points:[0,0,l.value.width,0],stroke:"black",strokeWidth:20,opacity:.5}},null,8,["config"]),d(U,{name:"y-axis",config:{x:10,y:0,points:[0,0,0,l.value.height],stroke:"black",strokeWidth:20,opacity:.5}},null,8,["config"]),d(r,{config:{x:x.value}},{default:k(()=>[(S(!0),$(Z,null,vt(yt.value,(_,nt)=>(S(),$(Z,{key:`x-tick-${nt}`},[d(U,{config:{x:_.x,y:15,points:[0,0,0,5],stroke:"white",strokeWidth:1}},null,8,["config"]),d(T,{config:{x:_.x-7,y:3,text:_.text,fontSize:10,fill:"white",align:"center"}},null,8,["config"])],64))),128))]),_:1},8,["config"]),d(r,{config:{y:w.value}},{default:k(()=>[(S(!0),$(Z,null,vt(bt.value,(_,nt)=>(S(),$(Z,{key:`y-tick-${nt}`},[d(U,{config:{x:15,y:_.y,points:[0,0,5,0],stroke:"white",strokeWidth:1}},null,8,["config"]),d(T,{config:{x:3,y:_.y+7,text:_.text,fontSize:10,rotation:270,fill:"white",align:"left"}},null,8,["config"])],64))),128))]),_:1},8,["config"])]),_:1},512),d(M,{visible:X.value,name:"verticalScrollbarLayer"},{default:k(()=>[d(e,{config:{x:l.value.width-v(s)-2,y:0,width:v(s)+2,height:l.value.height,fill:"#eee"}},null,8,["config"]),d(e,{ref_key:"verticalScrollbar",ref:pt,config:{x:l.value.width-v(s),y:wt.value,width:v(s),height:Y.value,fill:"#aaa",draggable:!0,dragBoundFunc:_=>({x:l.value.width-v(s),y:Math.max(0,Math.min(l.value.height-Y.value,_.y))}),stroke:"#999",strokeWidth:1},onDragmove:Et},null,8,["config"])]),_:1},8,["visible"]),d(M,{visible:H.value,name:"horizontalScrollbarLayer"},{default:k(()=>[d(e,{config:{x:0,y:l.value.height-v(s)-2,width:l.value.width,height:v(s)+2,fill:"#eee"}},null,8,["config"]),d(e,{ref_key:"horizontalScrollbar",ref:mt,config:{x:_t.value,y:l.value.height-v(s),width:N.value,height:v(s),fill:"#aaa",draggable:!0,dragBoundFunc:_=>({x:Math.max(0,Math.min(l.value.width-N.value,_.x)),y:l.value.height-v(s)}),stroke:"#999",strokeWidth:1},onDragmove:It},null,8,["config"])]),_:1},8,["visible"])]),_:1},8,["config"]))]),n("div",me,[d(ge)])])])}}}),$e=q({layout:Ft,__name:"PlotPage",props:{plots:{}},setup(L){const u=L;return Ot("plots",u.plots),(s,a)=>(S(),ht(Vt,{title:"Plot","show-footer":!1},{default:k(()=>[d(xe,{plots:u.plots,"plot-config":{SCROLLBAR_SIZE:12,UNIT_PIXELS:100,SIDEPANEL_WIDTH:224,VERTICAL_OFFSET:118,PADDING_PIXELS:50}},null,8,["plots"])]),_:1}))}});export{$e as default};
